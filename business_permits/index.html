<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>D3 Page Template</title>
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script type="text/javascript" src="http://d3js.org/d3.v3.min.js"></script>
    <script type="text/javascript" src="colorbrewer.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <style>

.bar {
  fill: steelblue;
}

.bar:hover {
  fill: brown;
}

.axis {
  font: 8px sans-serif;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.x.axis path {
  display: none;
}

    </style>
  <head>
<center>
  The Developer Services Review Program is designed to meet the special needs of owners, developers, architects and contractors working on moderately- to highly-complex construction or renovation projects. Eligible projects include high-rise buildings, mercantile buildings with more than 150,000 square feet, other occupancies with more than 80,000 square feet, buildings with foundations deeper than 12 feet, and residential projects that contain more than 25 units. This metric tracks the average number of days DOB takes to process individual Developer Services Permits, grouped by the week the permit was processed. The target average process time is within 89 days.
</center>
<br/>
<center>
<a href="https://data.cityofchicago.org/Administration-Finance/Performance-Metrics-Buildings-Time-to-Issue-Develo/ijdy-a94t">Click here for City of Chicago data</a>
</center>
</br>
</br>
  </head>
  <body>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <div>
      <div class="btn-group pull-right">
          <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
               Permits per Year <span class="caret"></span>
        </button>
          <ul class="dropdown-menu" role="menu">
            <li><a class="m" value="2011" href="#">2011</a></li>
            <li><a class="m" value="2012" href="#">2012</a></li>
            <li><a class="m" value="2013" href="#">2013</a></li>
            <li><a class="m" value="2014" href="#">2014</a></li>
          </ul>
      </div>

    <script>

var margin = {top: 20, right: 20, bottom: 30, left: 40},
    width = 1060 - margin.left - margin.right,
    height = 550 - margin.top - margin.bottom;

var x = d3.scale.ordinal()
    .rangeRoundBands([0, width], .1);

var y = d3.scale.linear()
    .range([height, 0]);

var xAxis = d3.svg.axis()
    .scale(x)
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left")
    .ticks(10, "");

var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

d3.json("http://data.cityofchicago.org/resource/ijdy-a94t.json", function(error, data) {
  x.domain(data.map(function(d) { return d.week; }));
  y.domain([0, d3.max(data, function(d) { return d.average_days_to_permit; })]);

  svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);

  svg.append("g")
      .attr("class", "y axis")
      .call(yAxis)
    .append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 6)
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .text("average days to permit");

  svg.selectAll(".bar")
      .data(data)
    .enter().append("rect")
      .attr("class", "bar")
      .attr("x", function(d) { return x(d.week); })
      .attr("width", x.rangeBand())
      .attr("y", function(d) { return y(d.average_days_to_permit); })
      .attr("height", function(d) { return height - y(d.average_days_to_permit); });

});

function type(d) {
  d.average_days_to_permit = +d.average_days_to_permit;
  return d;
}

</script>